{% extends 'base.html' %}

{% block head %} Application {% endblock %}

{% block body %}

    <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
        <h1 class="display-4">STAGES</h1>
        <h3 id="steps">#0</h3>
        <p class="lead">Quickly build an effective pricing table for your potential customers with this Bootstrap
            example. Itâ€™s built with default Bootstrap components and utilities with little customization.</p>
    </div>
    
    <div id="circles" class="container center" data-route="{{ url|safe }}">
        <!-- Three columns of text below the carousel -->
        <div class="row circles-item" >
            <div class="col-lg-4">
                <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
                    xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 140x140"
                    preserveAspectRatio="xMidYMid slice" focusable="false">
                    <title>Placeholder</title>
                    <rect id="circle1" width="100%" height="100%" fill="#777" />                    
                </svg>
                <h2>Step #1</h2>
                
            </div><!-- /.col-lg-4 -->
            <div class="col-lg-4">
                <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
                    xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 140x140"
                    preserveAspectRatio="xMidYMid slice" focusable="false">
                    <title>Placeholder</title>
                    <rect id="circle2" width="100%" height="100%" fill="#777" />                    
                </svg>
                <h2>Step #2</h2>                
            </div><!-- /.col-lg-4 -->
            <div class="col-lg-4">
                <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
                    xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 140x140"
                    preserveAspectRatio="xMidYMid slice" focusable="false">
                    <title>Placeholder</title>
                    <rect id="circle3" width="100%" height="100%" fill="#777" />     
                </svg>
                <h2>Step #3</h2>                
            </div><!-- /.col-lg-4 -->
        </div><!-- /.row -->
    </div>

    <script>            
        let URL = document.getElementById('circles').getAttribute("data-route");
        let intervalID = window.setInterval(getData, 1000, URL);
        function getData(URL) {          
          fetch(URL)
          .then(res => res.json())
          .then((data) => {                        
            console.log(data["task_id"])
            console.log(data["task_state"])
            console.log(data["data"])  
            if(data["data"]['step']) {
                document.getElementById("steps").innerHTML = "#" + data["data"]['step'];
            }
          })
          .catch(err => { throw err });
        }    
      </script>

{% endblock %}